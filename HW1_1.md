---


---

<h1 id="hw1">HW1</h1>
<p>20250929</p>
<h2 id="hw1_1">HW1_1</h2>
<pre class=" language-matlab"><code class="prism  language-matlab">clear<span class="token punctuation">;</span> clc<span class="token punctuation">;</span>

<span class="token comment">%% 1. Problem statement parameters setting</span>
k <span class="token operator">=</span> <span class="token number">0.49</span><span class="token punctuation">;</span> 
C <span class="token operator">=</span> <span class="token number">0.2174</span><span class="token punctuation">;</span>
rho <span class="token operator">=</span> <span class="token number">2.7</span><span class="token punctuation">;</span>
kappa <span class="token operator">=</span> k <span class="token operator">/</span> <span class="token punctuation">(</span>rho <span class="token operator">*</span> C<span class="token punctuation">)</span><span class="token punctuation">;</span>
dx <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
dt <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
L <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
t_total <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">;</span>
Nx <span class="token operator">=</span> L <span class="token operator">/</span> dx <span class="token operator">+</span> <span class="token number">1</span>
Nt <span class="token operator">=</span> t_total <span class="token operator">/</span> dt<span class="token punctuation">;</span>

<span class="token comment">%% 2. Temperature field initialization</span>
T <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Nx<span class="token punctuation">,</span> Nt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
x <span class="token operator">=</span> <span class="token function">linspace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> L<span class="token punctuation">,</span> Nx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">T</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token function">T</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

<span class="token comment">%% 3. Crank-Nicolson method parameters calculation</span>

c <span class="token operator">=</span> kappa <span class="token operator">*</span> dt <span class="token operator">/</span> <span class="token punctuation">(</span>dx<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
alpha <span class="token operator">=</span> c <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
beta <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> c<span class="token punctuation">;</span>

main_diag <span class="token operator">=</span> beta <span class="token operator">*</span> <span class="token function">ones</span><span class="token punctuation">(</span>Nx<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lower_diag <span class="token operator">=</span> <span class="token operator">-</span>alpha <span class="token operator">*</span> <span class="token function">ones</span><span class="token punctuation">(</span>Nx<span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
upper_diag <span class="token operator">=</span> <span class="token operator">-</span>alpha <span class="token operator">*</span> <span class="token function">ones</span><span class="token punctuation">(</span>Nx<span class="token number">-1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">main_diag</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token function">upper_diag</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token function">lower_diag</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">-</span>alpha<span class="token punctuation">;</span>
<span class="token function">main_diag</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> alpha<span class="token punctuation">;</span>
<span class="token function">upper_diag</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">-</span>alpha<span class="token punctuation">;</span>

A <span class="token operator">=</span> <span class="token function">diag</span><span class="token punctuation">(</span>main_diag<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">diag</span><span class="token punctuation">(</span>lower_diag<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">diag</span><span class="token punctuation">(</span>upper_diag<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 4. Time-iterative solution</span>
<span class="token keyword">for</span> n <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>Nt
	b <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Nx<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">b</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span>Nx<span class="token number">-1</span>
		<span class="token function">b</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">=</span> alpha <span class="token operator">*</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> c<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">+</span> alpha <span class="token operator">*</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">end</span>	
	<span class="token function">b</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token operator">=</span> alpha <span class="token operator">*</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token number">-1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> c<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">+</span> alpha <span class="token operator">*</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token keyword">end</span><span class="token number">-1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">T</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> A <span class="token operator">\</span> b<span class="token punctuation">;</span>
<span class="token keyword">end</span>

<span class="token comment">%% 5. Result output and visualization</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'Temperature of each node at t = 0.1s（x/cm → T/°C）：\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>Nx
	<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'x=%d → T=%.4f\n'</span><span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">,</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>

figure<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'o-'</span><span class="token punctuation">,</span> <span class="token string">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token string">'MarkerSize'</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Position x (cm)'</span><span class="token punctuation">,</span> <span class="token string">'FontSize'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Temprature T (°C)'</span><span class="token punctuation">,</span> <span class="token string">'FontSize'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'Temperature distribution at t = 0.1s'</span><span class="token punctuation">,</span> <span class="token string">'FontSize'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
grid on<span class="token punctuation">;</span>
</code></pre>
<p>Output :<br>
Temperature of each node at t = 0.1s（x/cm → T/°C）：<br>
x=0 → T=100.0000<br>
x=2 → T=2.0445<br>
x=4 → T=0.0209<br>
x=6 → T=0.0002<br>
x=8 → T=0.0000<br>
x=10 → T=0.0000<br>
<img src="https://github.com/Y1n9KC/Homework/blob/master/HW1_1.png" alt="enter image description here"></p>

