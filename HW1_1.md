---


---

<h1 id="hw1">HW1</h1>
<p>20250929</p>
<h2 id="hw1_1">HW1_1</h2>
<pre><code>clear; clc;

%% 1. Problem statement parameters setting
k = 0.49; 
C = 0.2174;
rho = 2.7;
kappa = k / (rho * C);
dx = 2;
dt = 0.1;
L = 10;
t_total = 0.2;
Nx = L / dx + 1
Nt = t_total / dt;

%% 2. Temperature field initialization
T = zeros(Nx, Nt + 1);
x = linspace(0, L, Nx);
T(:, 1) = 0;
T(1, :) = 100;

%% 3. Crank-Nicolson method parameters calculation

c = kappa * dt / (dx^2);
alpha = c / 2;
beta = 1 + c;

main_diag = beta * ones(Nx, 1);
lower_diag = -alpha * ones(Nx-1, 1);
upper_diag = -alpha * ones(Nx-1, 1);

main_diag(1) = 1;
upper_diag(1) = 0;
lower_diag(end) = -alpha;
main_diag(end) = 1 + alpha;
upper_diag(end) = -alpha;

A = diag(main_diag) + diag(lower_diag, -1) + diag(upper_diag, 1);

%% 4. Time-iterative solution
for n = 1:Nt
	b = zeros(Nx, 1);
	b(1) = T(1, n);
	for i = 2:Nx-1
		b(i) = alpha * T(i-1, n) + (1 - c) * T(i, n) + alpha * T(i+1, n);
	end	
	b(end) = alpha * T(end-1, n) + (1 - c) * T(end, n) + alpha * T(end-1, n);
	T(:, n+1) = A \ b;
end

%% 5. Result output and visualization
fprintf('Temperature of each node at t = 0.1s（x/cm → T/°C）：\n');
for i = 1:Nx
	fprintf('x=%d → T=%.4f\n', x(i), T(i, end));
end

figure;
plot(x, T(:, end), 'o-', 'LineWidth', 1.5, 'MarkerSize', 8);
xlabel('Position x (cm)', 'FontSize', 11);
ylabel('Temprature T (°C)', 'FontSize', 11);
title('Temperature distribution at t = 0.1s', 'FontSize', 12);
grid on;
</code></pre>
<p>Output :<br>
Temperature of each node at t = 0.1s（x/cm → T/°C）：<br>
x=0 → T=100.0000<br>
x=2 → T=2.0445<br>
x=4 → T=0.0209<br>
x=6 → T=0.0002<br>
x=8 → T=0.0000<br>
x=10 → T=0.0000</p>

